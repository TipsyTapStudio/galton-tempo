{
  "version": 3,
  "sources": ["../src/utils/url-params.ts", "../src/utils/seed.ts", "../src/engine/simulation.ts", "../src/engine/seven-seg.ts", "../src/engine/layout.ts", "../src/engine/grain-renderer.ts", "../src/engine/renderer.ts", "../src/engine/timer-bridge.ts", "../src/engine/audio.ts", "../src/components/console.ts", "../src/main.ts"],
  "sourcesContent": ["/**\n * URL parameter serialization for GALTON-TEMPO.\n */\n\nexport interface AppParams {\n  bpm: number;\n  bars: number;\n  rows: number;\n  s: number;\n  sound: string;\n  theme: string;\n  mode: string;\n}\n\nconst VALID_SOUNDS = ['click', 'kick', 'both'];\nconst VALID_THEMES = ['nixie', 'system', 'studio', 'cyber'];\nconst VALID_MODES = ['standard', 'heavy sand', 'techno', 'moon gravity', 'super ball'];\n\nconst DEFAULTS: AppParams = {\n  bpm: 120,\n  bars: 16,\n  rows: 24,\n  s: 0,\n  sound: 'click',\n  theme: 'nixie',\n  mode: 'standard',\n};\n\nexport function readParams(): AppParams {\n  const sp = new URLSearchParams(window.location.search);\n  const raw = (key: string, fallback: number): number => {\n    const v = sp.get(key);\n    if (v === null) return fallback;\n    const num = parseInt(v, 10);\n    return Number.isFinite(num) ? num : fallback;\n  };\n\n  let seed = raw('s', DEFAULTS.s);\n  if (seed === 0) {\n    seed = (Date.now() % 1_000_000) | 1;\n  }\n\n  const soundRaw = (sp.get('sound') || DEFAULTS.sound).toLowerCase().trim();\n  const sound = VALID_SOUNDS.includes(soundRaw) ? soundRaw : DEFAULTS.sound;\n\n  const themeRaw = (sp.get('theme') || DEFAULTS.theme).toLowerCase().trim();\n  const theme = VALID_THEMES.includes(themeRaw) ? themeRaw : DEFAULTS.theme;\n\n  const modeRaw = (sp.get('mode') || DEFAULTS.mode).toLowerCase().trim();\n  const mode = VALID_MODES.includes(modeRaw) ? modeRaw : DEFAULTS.mode;\n\n  return {\n    bpm: Math.max(20, Math.min(300, raw('bpm', DEFAULTS.bpm))),\n    bars: Math.max(1, Math.min(999, raw('bars', DEFAULTS.bars))),\n    rows: Math.max(4, Math.min(64, raw('rows', DEFAULTS.rows))),\n    s: seed,\n    sound,\n    theme,\n    mode,\n  };\n}\n\nexport function writeParams(cfg: AppParams): void {\n  const sp = new URLSearchParams();\n  sp.set('bpm', String(cfg.bpm));\n  sp.set('bars', String(cfg.bars));\n  sp.set('rows', String(cfg.rows));\n  sp.set('s', String(cfg.s));\n  sp.set('sound', cfg.sound);\n  sp.set('theme', cfg.theme);\n  sp.set('mode', cfg.mode);\n  const url = `${window.location.pathname}?${sp.toString()}`;\n  window.history.replaceState(null, '', url);\n}\n", "/**\n * Seed-based deterministic PRNG (mulberry32).\n * Math.random() is FORBIDDEN in this project.\n * All randomness must flow through this module.\n */\nexport function createPRNG(seed: number): () => number {\n  let s = seed | 0;\n  return (): number => {\n    s |= 0;\n    s = (s + 0x6d2b79f5) | 0;\n    let t = Math.imul(s ^ (s >>> 15), 1 | s);\n    t = (t + Math.imul(t ^ (t >>> 7), 61 | t)) ^ t;\n    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n  };\n}\n\n/** Hash a string into a numeric seed. */\nexport function hashSeed(str: string): number {\n  let h = 0;\n  for (let i = 0; i < str.length; i++) {\n    h = (Math.imul(31, h) + str.charCodeAt(i)) | 0;\n  }\n  return h >>> 0;\n}\n", "/**\n * Physics-based particle simulation \u2014 BPM-synced emission for GALTON-TEMPO.\n *\n * Key difference from GALTON-TIMER:\n *   TIMER: emitInterval = totalTime / totalParticles (time-linear)\n *   TEMPO: emitInterval = 60000 / bpm (BPM-synced, one grain per beat)\n *\n * Peg collision callback enables sound triggering.\n */\n\n// \u2500\u2500 Types \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport interface Particle {\n  path: number[];       // 0=left, 1=right at each peg row\n  bin: number;          // final bin = sum(path)\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  pegIndex: number;     // next peg row to interact with\n  settled: boolean;\n  jitter: number;\n  beatIndex: number;    // which beat this particle was emitted on\n}\n\nexport interface BoardGeom {\n  emitX: number;\n  emitY: number;\n  pegX: (row: number, index: number) => number;\n  pegY: (row: number) => number;\n  pegSpacing: number;\n  numRows: number;\n  accBottom: number;\n}\n\nexport interface SimConfig {\n  numRows: number;\n  totalBeats: number;   // bars * beatsPerBar\n  bpm: number;\n  rng: () => number;\n}\n\n// \u2500\u2500 Physics constants \u2500\u2500\n\nexport type PhysicsParams = {\n  restitution: number;\n  restitutionRange: number;\n  nudge: number;\n  dragX: number;\n  dragY: number;\n  dragXSettle: number;\n  dragYSettle: number;\n  gravity: number;\n};\n\nexport const PRESETS: Record<string, PhysicsParams> = {\n  'Standard': {\n    restitution: 0.20, restitutionRange: 0.08,\n    nudge: 0.08,\n    dragX: 3.0, dragY: 1.5, dragXSettle: 6.0, dragYSettle: 3.0, gravity: 800,\n  },\n  'Heavy Sand': {\n    restitution: 0.01, restitutionRange: 0.02,\n    nudge: 0.10,\n    dragX: 6.0, dragY: 2.0, dragXSettle: 14.0, dragYSettle: 7.0, gravity: 1400,\n  },\n  'Techno': {\n    restitution: 0.0, restitutionRange: 0.0,\n    nudge: 0.15,\n    dragX: 10.0, dragY: 1.0, dragXSettle: 18.0, dragYSettle: 4.0, gravity: 1600,\n  },\n  'Moon Gravity': {\n    restitution: 0.08, restitutionRange: 0.03,\n    nudge: 0.12,\n    dragX: 2.0, dragY: 0.08, dragXSettle: 3.0, dragYSettle: 0.8, gravity: 50,\n  },\n  'Super Ball': {\n    restitution: 0.70, restitutionRange: 0.15,\n    nudge: 0.04,\n    dragX: 0.8, dragY: 0.4, dragXSettle: 2.5, dragYSettle: 1.2, gravity: 800,\n  },\n};\n\nexport const PHYSICS: PhysicsParams = { ...PRESETS['Standard'] };\n\n// \u2500\u2500 Helpers \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nfunction fract(x: number): number {\n  return x - Math.floor(x);\n}\n\nfunction timeToHit(y: number, vy: number, g: number, targetY: number): number {\n  const dy = targetY - y;\n  if (dy <= 0) return 0;\n  if (Math.abs(g) < 1e-6) {\n    return vy > 1e-9 ? dy / vy : Infinity;\n  }\n  const disc = vy * vy + 2 * g * dy;\n  if (disc < 0) return Infinity;\n  const sqrtDisc = Math.sqrt(disc);\n  const t1 = (-vy + sqrtDisc) / g;\n  const t2 = (-vy - sqrtDisc) / g;\n  let t = Infinity;\n  if (t1 > 1e-9) t = t1;\n  if (t2 > 1e-9 && t2 < t) t = t2;\n  return t;\n}\n\nexport function maxBinProbability(numRows: number): number {\n  const k = Math.floor(numRows / 2);\n  let logC = 0;\n  for (let i = 1; i <= numRows; i++) logC += Math.log(i);\n  for (let i = 1; i <= k; i++) logC -= Math.log(i);\n  for (let i = 1; i <= numRows - k; i++) logC -= Math.log(i);\n  return Math.exp(logC - numRows * Math.LN2);\n}\n\n// \u2500\u2500 Simulation \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nconst PEG_COLLISION_FRAC = 0.30;\n\nexport class Simulation {\n  readonly numRows: number;\n  readonly totalParticles: number;\n  totalTimeMs: number;\n\n  binCounts: number[];\n  activeParticles: Particle[] = [];\n  emittedCount = 0;\n  elapsedMs = 0;\n  allEmitted = false;\n  allSettled = false;\n\n  /** Callback: fired when a particle collides with a peg. */\n  onPegHit: ((row: number, col: number, numRows: number) => void) | null = null;\n\n  private rng: () => number;\n  emitIntervalMs: number;\n\n  constructor(cfg: SimConfig) {\n    this.numRows = cfg.numRows;\n    this.totalParticles = cfg.totalBeats;\n    this.emitIntervalMs = 60000 / cfg.bpm;\n    this.totalTimeMs = cfg.totalBeats * this.emitIntervalMs;\n    this.rng = cfg.rng;\n    this.binCounts = new Array(cfg.numRows + 1).fill(0);\n  }\n\n  update(\n    dtMs: number,\n    geom: BoardGeom,\n    getGroundY: (x: number) => number,\n  ): Particle[] {\n    const dt = Math.min(dtMs, 100) / 1000;\n    const settled: Particle[] = [];\n\n    // \u2500\u2500 Emission (BPM-synced) \u2500\u2500\n    if (!this.allEmitted) {\n      const expectedEmitted = Math.min(\n        this.totalParticles,\n        Math.floor(this.elapsedMs / this.emitIntervalMs),\n      );\n      const toEmit = expectedEmitted - this.emittedCount;\n      for (let i = 0; i < toEmit; i++) {\n        this.activeParticles.push(this.createParticle(geom));\n      }\n      if (this.emittedCount >= this.totalParticles) this.allEmitted = true;\n    }\n\n    // \u2500\u2500 Physics \u2500\u2500\n    const alive: Particle[] = [];\n    const halfBoard = geom.pegSpacing * (this.numRows / 2 + 1.5);\n    const pegR = geom.pegSpacing * PEG_COLLISION_FRAC;\n\n    for (const p of this.activeParticles) {\n      const g = PHYSICS.gravity;\n\n      const settling = p.pegIndex >= this.numRows;\n      const dxCoeff = settling ? PHYSICS.dragXSettle : PHYSICS.dragX;\n      const dyCoeff = settling ? PHYSICS.dragYSettle : PHYSICS.dragY;\n      p.vx *= Math.exp(-dxCoeff * dt);\n      p.vy *= Math.exp(-dyCoeff * dt);\n\n      let remainDt = dt;\n      let didSettle = false;\n      const MAX_CCD_ITER = this.numRows + 2;\n\n      for (let iter = 0; iter < MAX_CCD_ITER && remainDt > 0; iter++) {\n        if (p.pegIndex < this.numRows) {\n          const pegRowY = geom.pegY(p.pegIndex);\n          const tHit = timeToHit(p.y, p.vy, g, pegRowY);\n\n          if (tHit > remainDt) {\n            p.x += p.vx * remainDt;\n            p.y += p.vy * remainDt + 0.5 * g * remainDt * remainDt;\n            p.vy += g * remainDt;\n            remainDt = 0;\n            break;\n          }\n\n          p.x += p.vx * tHit;\n          p.vy += g * tHit;\n          p.y = pegRowY;\n          remainDt -= tHit;\n\n          const dir = p.path[p.pegIndex];\n          const bj = fract(p.jitter * 997.0 + p.pegIndex * 7.31);\n\n          let hIdx = 0;\n          for (let i = 0; i < p.pegIndex; i++) hIdx += p.path[i];\n          const pegCX = geom.pegX(p.pegIndex, hIdx);\n\n          const nudge = PHYSICS.nudge;\n          p.x = p.x * (1 - nudge) + pegCX * nudge;\n\n          let dx = p.x - pegCX;\n          const minOff = pegR * (0.10 + 0.12 * bj);\n          if (dir === 1 && dx < minOff) dx = minOff;\n          if (dir === 0 && dx > -minOff) dx = -minOff;\n          dx = Math.max(-pegR, Math.min(pegR, dx));\n\n          const frac = dx / pegR;\n          const nx = frac;\n          const ny = -Math.sqrt(Math.max(0, 1 - frac * frac));\n\n          const vDotN = p.vx * nx + p.vy * ny;\n          if (vDotN < 0) {\n            const e = PHYSICS.restitution + PHYSICS.restitutionRange * bj;\n            p.vx -= (1 + e) * vDotN * nx;\n            p.vy -= (1 + e) * vDotN * ny;\n          }\n\n          // Fire peg collision callback\n          this.onPegHit?.(p.pegIndex, hIdx, this.numRows);\n\n          p.pegIndex++;\n        } else {\n          const groundY = getGroundY(p.x);\n          const tGround = timeToHit(p.y, p.vy, g, groundY);\n\n          if (tGround > remainDt) {\n            p.x += p.vx * remainDt;\n            p.y += p.vy * remainDt + 0.5 * g * remainDt * remainDt;\n            p.vy += g * remainDt;\n            remainDt = 0;\n            break;\n          }\n\n          p.x += p.vx * tGround;\n          p.y = groundY;\n          p.settled = true;\n          this.binCounts[p.bin]++;\n          settled.push(p);\n          didSettle = true;\n          break;\n        }\n      }\n\n      if (didSettle) continue;\n      p.x = Math.max(geom.emitX - halfBoard, Math.min(geom.emitX + halfBoard, p.x));\n      alive.push(p);\n    }\n\n    this.activeParticles = alive;\n    if (this.allEmitted && alive.length === 0) this.allSettled = true;\n\n    return settled;\n  }\n\n  setElapsedMs(ms: number): void {\n    this.elapsedMs = ms;\n  }\n\n  /** Get current beat index (0-based). */\n  getCurrentBeat(): number {\n    return Math.min(this.totalParticles, Math.floor(this.elapsedMs / this.emitIntervalMs));\n  }\n\n  /** Get current bar (0-based). */\n  getCurrentBar(beatsPerBar: number): number {\n    return Math.floor(this.getCurrentBeat() / beatsPerBar);\n  }\n\n  instantSnap(geom: BoardGeom): Particle[] {\n    const expectedEmitted = Math.min(\n      this.totalParticles,\n      Math.floor(this.elapsedMs / this.emitIntervalMs),\n    );\n    const toEmit = expectedEmitted - this.emittedCount;\n    if (toEmit <= 0) return [];\n\n    const settled: Particle[] = [];\n    for (let i = 0; i < toEmit; i++) {\n      const p = this.createParticle(geom);\n      p.settled = true;\n      p.pegIndex = this.numRows;\n      this.binCounts[p.bin]++;\n      settled.push(p);\n    }\n\n    if (this.emittedCount >= this.totalParticles) this.allEmitted = true;\n    return settled;\n  }\n\n  forceSettleActive(): Particle[] {\n    const settled: Particle[] = [];\n    for (const p of this.activeParticles) {\n      p.settled = true;\n      p.pegIndex = this.numRows;\n      this.binCounts[p.bin]++;\n      settled.push(p);\n    }\n    this.activeParticles = [];\n    return settled;\n  }\n\n  private createParticle(geom: BoardGeom): Particle {\n    const path: number[] = [];\n    let bin = 0;\n    for (let i = 0; i < this.numRows; i++) {\n      const d = this.rng() < 0.5 ? 0 : 1;\n      path.push(d);\n      bin += d;\n    }\n    const beatIndex = this.emittedCount;\n    this.emittedCount++;\n    return {\n      path, bin,\n      x: geom.emitX, y: geom.emitY,\n      vx: 0, vy: 0,\n      pegIndex: 0, settled: false,\n      jitter: this.rng(),\n      beatIndex,\n    };\n  }\n}\n", "/**\n * Seven-segment neon clock renderer.\n *\n * Segment layout:\n *   \u2500a\u2500\n *  \u2502   \u2502\n *  f   b\n *  \u2502   \u2502\n *   \u2500g\u2500\n *  \u2502   \u2502\n *  e   c\n *  \u2502   \u2502\n *   \u2500d\u2500\n *\n * Rendering: no shadowBlur. Glow via multi-pass overlay at scaled width.\n * Ultra-thin segments \u2014 glow is the star, core is the whisper.\n */\n\n// \u2500\u2500 Segment map: [a,b,c,d,e,f,g] per digit 0-9 \u2500\u2500\n\nexport const DIGIT_SEGMENTS: boolean[][] = [\n  [true,  true,  true,  true,  true,  true,  false], // 0\n  [false, true,  true,  false, false, false, false], // 1\n  [true,  true,  false, true,  true,  false, true],  // 2\n  [true,  true,  true,  true,  false, false, true],  // 3\n  [false, true,  true,  false, false, true,  true],  // 4\n  [true,  false, true,  true,  false, true,  true],  // 5\n  [true,  false, true,  true,  true,  true,  true],  // 6\n  [true,  true,  true,  false, false, false, false], // 7\n  [true,  true,  true,  true,  true,  true,  true],  // 8\n  [true,  true,  true,  true,  false, true,  true],  // 9\n];\n\n// \u2500\u2500 Theme interface \u2500\u2500\n\nexport interface ClockTheme {\n  name: string;\n  segmentRGB: [number, number, number];\n  grainRGB: [number, number, number];\n  glowIntensity: number;\n}\n\nexport const CLOCK_THEMES: ClockTheme[] = [\n  { name: 'Nixie',  segmentRGB: [255, 147, 41],  grainRGB: [255, 180, 100], glowIntensity: 1.2 },\n  { name: 'System', segmentRGB: [0, 255, 65],     grainRGB: [120, 255, 140], glowIntensity: 0.8 },\n  { name: 'Studio', segmentRGB: [220, 220, 230],  grainRGB: [230, 230, 240], glowIntensity: 1.0 },\n  { name: 'Cyber',  segmentRGB: [0, 150, 255],    grainRGB: [80, 180, 255],  glowIntensity: 1.0 },\n];\n\nexport function getThemeByName(name: string): ClockTheme {\n  const lower = name.toLowerCase();\n  return CLOCK_THEMES.find(t => t.name.toLowerCase() === lower) || CLOCK_THEMES[0];\n}\n\n// \u2500\u2500 Segment geometry helpers \u2500\u2500\n\nfunction drawSegmentPath(\n  ctx: CanvasRenderingContext2D,\n  x: number, y: number,\n  w: number, h: number,\n  segIndex: number,\n  thickness: number,\n): void {\n  const ht = thickness / 2;\n  const margin = thickness * 0.3;\n\n  let sx: number, sy: number, len: number, horizontal: boolean;\n\n  switch (segIndex) {\n    case 0: sx = x + margin; sy = y; len = w - margin * 2; horizontal = true; break;\n    case 1: sx = x + w; sy = y + margin; len = h / 2 - margin * 2; horizontal = false; break;\n    case 2: sx = x + w; sy = y + h / 2 + margin; len = h / 2 - margin * 2; horizontal = false; break;\n    case 3: sx = x + margin; sy = y + h; len = w - margin * 2; horizontal = true; break;\n    case 4: sx = x; sy = y + h / 2 + margin; len = h / 2 - margin * 2; horizontal = false; break;\n    case 5: sx = x; sy = y + margin; len = h / 2 - margin * 2; horizontal = false; break;\n    case 6: sx = x + margin; sy = y + h / 2; len = w - margin * 2; horizontal = true; break;\n    default: return;\n  }\n\n  if (horizontal) {\n    ctx.moveTo(sx, sy);\n    ctx.lineTo(sx + ht, sy - ht);\n    ctx.lineTo(sx + len - ht, sy - ht);\n    ctx.lineTo(sx + len, sy);\n    ctx.lineTo(sx + len - ht, sy + ht);\n    ctx.lineTo(sx + ht, sy + ht);\n    ctx.closePath();\n  } else {\n    ctx.moveTo(sx, sy);\n    ctx.lineTo(sx - ht, sy + ht);\n    ctx.lineTo(sx - ht, sy + len - ht);\n    ctx.lineTo(sx, sy + len);\n    ctx.lineTo(sx + ht, sy + len - ht);\n    ctx.lineTo(sx + ht, sy + ht);\n    ctx.closePath();\n  }\n}\n\n// \u2500\u2500 Public drawing functions \u2500\u2500\n\nexport function drawDigit(\n  ctx: CanvasRenderingContext2D,\n  x: number, y: number,\n  w: number, h: number,\n  segments: boolean[],\n  rgb: [number, number, number],\n  glowIntensity: number,\n): void {\n  const thickness = Math.max(1.2, w * 0.07);\n\n  const glowScales = [5.5, 4.5, 3.5, 2.8, 2.2, 1.8];\n  const glowAlphaFactors = [0.5, 0.7, 1.0, 1.0, 1.2, 1.2];\n\n  for (let s = 0; s < 7; s++) {\n    if (segments[s]) {\n      const glowAlpha = 0.09 * glowIntensity;\n      for (let pass = 0; pass < 6; pass++) {\n        ctx.fillStyle = `rgba(${rgb[0]},${rgb[1]},${rgb[2]},${(glowAlpha * glowAlphaFactors[pass]).toFixed(4)})`;\n        ctx.beginPath();\n        drawSegmentPath(ctx, x, y, w, h, s, thickness * glowScales[pass]);\n        ctx.fill();\n      }\n\n      ctx.fillStyle = `rgba(${rgb[0]},${rgb[1]},${rgb[2]},0.85)`;\n      ctx.beginPath();\n      drawSegmentPath(ctx, x, y, w, h, s, thickness);\n      ctx.fill();\n    } else {\n      ctx.fillStyle = `rgba(${rgb[0]},${rgb[1]},${rgb[2]},0.02)`;\n      ctx.beginPath();\n      drawSegmentPath(ctx, x, y, w, h, s, thickness);\n      ctx.fill();\n    }\n  }\n}\n\n/**\n * Draw BPM value centered at (cx, cy) using seven-segment digits.\n */\nexport function drawBPM(\n  ctx: CanvasRenderingContext2D,\n  bpm: number,\n  cx: number, cy: number,\n  digitH: number,\n  theme: ClockTheme,\n): void {\n  const digits = String(Math.round(bpm)).split('').map(Number);\n  const digitW = digitH * 0.50;\n  const gap = digitW * 0.35;\n\n  const rgb = theme.segmentRGB;\n  const glow = theme.glowIntensity;\n\n  const totalW = digits.length * digitW + (digits.length - 1) * gap;\n  let dx = cx - totalW / 2;\n  const startY = cy - digitH / 2;\n\n  for (const d of digits) {\n    drawDigit(ctx, dx, startY, digitW, digitH, DIGIT_SEGMENTS[d], rgb, glow);\n    dx += digitW + gap;\n  }\n}\n\n/**\n * Draw clock centered at (cx, cy).\n */\nexport function drawClock(\n  ctx: CanvasRenderingContext2D,\n  totalSec: number,\n  cx: number, cy: number,\n  digitH: number,\n  theme: ClockTheme,\n  centiseconds?: number,\n  showHours?: boolean,\n): void {\n  const hh = Math.floor(totalSec / 3600);\n  const mm = Math.floor((totalSec % 3600) / 60);\n  const ss = Math.floor(totalSec % 60);\n\n  const digitW = digitH * 0.50;\n  const pairGap = digitW * 0.35;\n  const groupGap = digitW * 1.3;\n\n  const rgb = theme.segmentRGB;\n  const glow = theme.glowIntensity;\n\n  let groups: number[][];\n  if (centiseconds !== undefined) {\n    groups = [\n      [Math.floor(mm / 10), mm % 10],\n      [Math.floor(ss / 10), ss % 10],\n      [Math.floor(centiseconds / 10), centiseconds % 10],\n    ];\n  } else if (hh > 0 || showHours) {\n    groups = [\n      [Math.floor(hh / 10), hh % 10],\n      [Math.floor(mm / 10), mm % 10],\n      [Math.floor(ss / 10), ss % 10],\n    ];\n  } else {\n    groups = [\n      [Math.floor(mm / 10), mm % 10],\n      [Math.floor(ss / 10), ss % 10],\n    ];\n  }\n\n  const numGroups = groups.length;\n  const pairW = digitW * 2 + pairGap;\n  const totalW = pairW * numGroups + groupGap * (numGroups - 1);\n  const startX = cx - totalW / 2;\n  const startY = cy - digitH / 2;\n\n  let dx = startX;\n  const dotR = Math.max(1.2, digitW * 0.08);\n\n  for (let g = 0; g < numGroups; g++) {\n    const [d1, d2] = groups[g];\n    drawDigit(ctx, dx, startY, digitW, digitH, DIGIT_SEGMENTS[d1], rgb, glow);\n    dx += digitW + pairGap;\n    drawDigit(ctx, dx, startY, digitW, digitH, DIGIT_SEGMENTS[d2], rgb, glow);\n    dx += digitW;\n\n    if (g < numGroups - 1) {\n      const colonX = dx + groupGap / 2;\n      // Colon dots\n      const topY = cy - digitH * 0.20;\n      const botY = cy + digitH * 0.20;\n      const glowAlpha = 0.09 * glow;\n      for (const dy of [topY, botY]) {\n        for (let pass = 0; pass < 3; pass++) {\n          const scale = [3.0, 2.2, 1.6][pass];\n          const factor = [0.6, 0.9, 1.1][pass];\n          ctx.fillStyle = `rgba(${rgb[0]},${rgb[1]},${rgb[2]},${(glowAlpha * factor).toFixed(4)})`;\n          ctx.beginPath();\n          ctx.arc(colonX, dy, dotR * scale, 0, Math.PI * 2);\n          ctx.fill();\n        }\n        ctx.fillStyle = `rgba(${rgb[0]},${rgb[1]},${rgb[2]},0.4)`;\n        ctx.beginPath();\n        ctx.arc(colonX, dy, dotR, 0, Math.PI * 2);\n        ctx.fill();\n      }\n      dx += groupGap;\n    }\n  }\n}\n", "/**\n * Pure geometry \u2014 no canvas, no DOM.\n * Copied from GALTON-TIMER with minor adjustments.\n */\n\nimport { maxBinProbability } from './simulation';\n\nexport const SQRT3_2 = Math.sqrt(3) / 2;\n\nexport interface Layout {\n  width: number;\n  height: number;\n  dpr: number;\n  centerX: number;\n  contentW: number;\n  hopperTop: number;\n  hopperJunction: number;\n  hopperBottom: number;\n  hopperRectHW: number;\n  hopperTopHW: number;\n  nozzleHW: number;\n  hopperSigma: number;\n  emitY: number;\n  boardTop: number;\n  boardBottom: number;\n  accTop: number;\n  accBottom: number;\n  accHeight: number;\n  inlineTimerY: number;\n  pegSpacing: number;\n  rowSpacingY: number;\n  numRows: number;\n  pegRadius: number;\n  grainRadius: number;\n  settledDiameter: number;\n  settledRadius: number;\n  stackScale: number;\n  stackRowH: number;\n  miniGrainR: number;\n}\n\nexport function computeLayout(\n  w: number, h: number, dpr: number,\n  numRows: number, totalParticles: number,\n): Layout {\n  const centerX = w / 2;\n  const marginX = w * 0.15;\n  const contentW = w - marginX * 2;\n\n  const topMargin = h * 0.05;\n  const bottomMargin = h * 0.15;\n  const safeH = h - topMargin - bottomMargin;\n\n  const dxFromWidth = contentW / (numRows + 2);\n  const inlineTimerH = h * 0.06;\n  const gapBudget = h * 0.03;\n  const availableForSystem = safeH - inlineTimerH - gapBudget;\n\n  const boardH_target = availableForSystem * 3 / 5;\n  const dxFromRatio = numRows > 1\n    ? boardH_target / ((numRows - 1) * SQRT3_2)\n    : dxFromWidth;\n\n  const pegSpacing = Math.min(dxFromWidth, dxFromRatio);\n  const rowSpacingY = pegSpacing * SQRT3_2;\n  const boardH = numRows > 1 ? (numRows - 1) * rowSpacingY : 0;\n\n  const grainRadius = Math.max(1.2, Math.min(3.5, pegSpacing * 0.09));\n  const pegRadius = Math.max(1.5, Math.min(5.0, pegSpacing * 0.12));\n\n  const nozzleHW = pegSpacing * 0.8;\n  const gridHW = (numRows * pegSpacing) / 2;\n  const hopperTopHW = Math.max(pegSpacing * 4, gridHW * 1.3);\n  const hopperRectHW = hopperTopHW;\n\n  const taperH = Math.max(boardH / 3, pegSpacing * 2.5);\n\n  const hopperToGrid = Math.max(pegSpacing * 0.6, h * 0.012);\n  const gridToAcc = Math.max(pegSpacing * 0.7, h * 0.015);\n\n  const accBottom = h - bottomMargin;\n  const aboveAccH = inlineTimerH + taperH + hopperToGrid + boardH + gridToAcc;\n  const accHeight_available = safeH - aboveAccH;\n  const accHeight = Math.max(pegSpacing * 2, Math.min(accHeight_available, boardH / 2));\n\n  const maxProb = maxBinProbability(numRows);\n  const maxBinCount = maxProb * totalParticles * 1.15;\n\n  const accTop = accBottom - accHeight;\n  const boardBottom = accTop - gridToAcc;\n  const boardTopY = boardBottom - boardH;\n  const hopperBottom = boardTopY - hopperToGrid;\n  const hopperTop = hopperBottom - taperH;\n  const hopperJunction = hopperTop;\n  const emitY = hopperBottom + hopperToGrid * 0.55;\n  const inlineTimerY = Math.max(topMargin + inlineTimerH * 0.5, hopperTop - inlineTimerH * 0.6);\n\n  const stackScale = (accHeight * 0.85) / (maxProb * totalParticles);\n\n  const d_natural = grainRadius * 1.6;\n  const rowH_natural = d_natural * SQRT3_2;\n  const peakCeiling = accHeight * 0.95;\n  const stackRowH = maxBinCount > 0\n    ? Math.min(rowH_natural, peakCeiling / maxBinCount)\n    : rowH_natural;\n\n  const miniGrainR = Math.max(0.8, grainRadius * 0.55);\n\n  // Vertical centering\n  let finalHopperTop = hopperTop;\n  let finalHopperJunction = hopperJunction;\n  let finalHopperBottom = hopperBottom;\n  let finalEmitY = emitY;\n  let finalBoardTop = boardTopY;\n  let finalBoardBottom = boardBottom;\n  let finalAccTop = accTop;\n  let finalAccBottom = accBottom;\n  let finalInlineTimerY = inlineTimerY;\n\n  const contentTop = finalInlineTimerY - inlineTimerH * 0.5;\n  const contentBottom = finalAccBottom;\n  const totalContentH = contentBottom - contentTop;\n  const idealOffsetY = (h - totalContentH) / 2 - contentTop;\n  const uiSafeBottom = h * 0.12;\n  const maxOffset = (h - uiSafeBottom) - finalAccBottom;\n  const minOffset = topMargin - contentTop;\n  const offsetY = Math.max(minOffset, Math.min(idealOffsetY, maxOffset));\n\n  finalHopperTop += offsetY;\n  finalHopperJunction += offsetY;\n  finalHopperBottom += offsetY;\n  finalEmitY += offsetY;\n  finalBoardTop += offsetY;\n  finalBoardBottom += offsetY;\n  finalAccTop += offsetY;\n  finalAccBottom += offsetY;\n  finalInlineTimerY += offsetY;\n\n  return {\n    width: w, height: h, dpr, centerX, contentW,\n    hopperTop: finalHopperTop,\n    hopperJunction: finalHopperJunction,\n    hopperBottom: finalHopperBottom,\n    hopperRectHW, hopperTopHW: hopperRectHW, nozzleHW,\n    hopperSigma: taperH * 0.47 / pegSpacing,\n    emitY: finalEmitY,\n    boardTop: finalBoardTop, boardBottom: finalBoardBottom,\n    accTop: finalAccTop, accBottom: finalAccBottom, accHeight,\n    inlineTimerY: finalInlineTimerY,\n    pegSpacing, rowSpacingY, numRows, pegRadius,\n    grainRadius, settledDiameter: stackRowH,\n    settledRadius: stackRowH / 2,\n    stackScale, stackRowH, miniGrainR,\n  };\n}\n\nexport function pegX(L: Layout, row: number, index: number): number {\n  return L.centerX + (index - row / 2) * L.pegSpacing;\n}\n\nexport function pegY(L: Layout, row: number): number {\n  return L.boardTop + row * L.rowSpacingY;\n}\n\nexport function gaussianHW(y: number, L: Layout): number {\n  const totalH = L.hopperBottom - L.hopperTop;\n  if (totalH <= 0) return L.nozzleHW;\n  const t = Math.max(0, Math.min(1, (L.hopperBottom - y) / totalH));\n  const sigPx = L.hopperSigma * L.pegSpacing;\n  const d = t * totalH;\n  const gaussVal = 1 - Math.exp(-(d * d) / (2 * sigPx * sigPx));\n  return L.nozzleHW + (L.hopperTopHW - L.nozzleHW) * gaussVal;\n}\n\nexport interface HopperGrain { x: number; y: number; }\n\nexport function computeHopperGrains(\n  L: Layout, totalCount: number, grainR: number,\n): HopperGrain[] {\n  const grains: HopperGrain[] = [];\n  const d = grainR * 2.1;\n  const rowH = d * SQRT3_2;\n  const cx = L.centerX;\n\n  let row = 0;\n  let y = L.hopperBottom - grainR * 1.5;\n\n  while (grains.length < totalCount) {\n    const hw = gaussianHW(y, L);\n    const usableW = hw * 0.88;\n    const xOff = (row % 2 === 1) ? d * 0.5 : 0;\n    const nCols = Math.max(1, Math.floor((usableW * 2) / d));\n\n    for (let c = 0; c < nCols && grains.length < totalCount; c++) {\n      const gx = cx - usableW + xOff + c * d + grainR;\n      const seed = (row * 1009 + c * 7919 + 31337) & 0x7fffffff;\n      const jx = ((seed % 1000) / 1000 - 0.5) * grainR * 0.5;\n      const jy = (((seed * 1103515245 + 12345) & 0x7fffffff) % 1000 / 1000 - 0.5) * grainR * 0.4;\n      grains.push({ x: gx + jx, y: y + jy });\n    }\n\n    y -= rowH;\n    row++;\n  }\n  return grains;\n}\n\nexport function stackJitterX(bin: number, k: number, maxJitter: number): number {\n  const hash = ((bin * 2654435761 + k * 340573321) >>> 0) & 0x7fffffff;\n  return (hash % 10000 / 10000 - 0.5) * 2 * maxJitter;\n}\n\nexport function stackJitterY(bin: number, k: number, maxJitter: number): number {\n  const hash = ((bin * 1103515245 + k * 1299709) >>> 0) & 0x7fffffff;\n  return (hash % 10000 / 10000 - 0.5) * 2 * maxJitter;\n}\n", "/**\n * GrainRenderer \u2014 owns both canvases + all grain/peg/hopper drawing.\n * Copied from GALTON-TIMER.\n */\n\nimport type { Particle } from './simulation';\nimport type { ClockTheme } from './seven-seg';\nimport {\n  Layout, HopperGrain,\n  pegX, pegY,\n  stackJitterX, stackJitterY,\n  computeHopperGrains,\n  gaussianHW,\n} from './layout';\n\nconst PI2 = Math.PI * 2;\n\nconst GRAIN_ALPHA = 0.85;\nconst GRAIN_GLOW_ALPHA = 0.06;\nconst GRAIN_GLOW_SCALE = 2.5;\nconst STATIC_GRAIN_ALPHA = 1.0;\n\nexport class GrainRenderer {\n  readonly staticCanvas: HTMLCanvasElement;\n  readonly dynamicCanvas: HTMLCanvasElement;\n  readonly sCtx: CanvasRenderingContext2D;\n  readonly dCtx: CanvasRenderingContext2D;\n\n  private binCounts: number[];\n  private hopperGrainCache: HopperGrain[] = [];\n  private hopperGrainTopY = 0;\n  private hopperFadeAlpha = 1;\n\n  private grainCoreFill = '';\n  private grainGlowFill = '';\n  private staticGrainFill = '';\n\n  constructor(container: HTMLElement) {\n    this.staticCanvas = document.createElement('canvas');\n    this.dynamicCanvas = document.createElement('canvas');\n    for (const c of [this.staticCanvas, this.dynamicCanvas]) {\n      c.style.position = 'absolute';\n      c.style.top = '0';\n      c.style.left = '0';\n      container.appendChild(c);\n    }\n    this.sCtx = this.staticCanvas.getContext('2d')!;\n    this.dCtx = this.dynamicCanvas.getContext('2d')!;\n    this.binCounts = [];\n  }\n\n  updateGrainColors(theme: ClockTheme): void {\n    const [r, g, b] = theme.grainRGB;\n    this.grainCoreFill = `rgba(${r},${g},${b},${GRAIN_ALPHA})`;\n    this.grainGlowFill = `rgba(${r},${g},${b},${GRAIN_GLOW_ALPHA})`;\n    this.staticGrainFill = `rgba(${r},${g},${b},${STATIC_GRAIN_ALPHA})`;\n  }\n\n  applyLayout(L: Layout, totalParticles: number): void {\n    const w = L.width;\n    const h = L.height;\n    const dpr = L.dpr;\n\n    for (const c of [this.staticCanvas, this.dynamicCanvas]) {\n      c.width = w * dpr;\n      c.height = h * dpr;\n      c.style.width = w + 'px';\n      c.style.height = h + 'px';\n    }\n    this.sCtx.setTransform(dpr, 0, 0, dpr, 0, 0);\n    this.dCtx.setTransform(dpr, 0, 0, dpr, 0, 0);\n\n    this.binCounts = new Array(L.numRows + 1).fill(0);\n    this.sCtx.clearRect(0, 0, w, h);\n\n    this.hopperGrainCache = computeHopperGrains(L, totalParticles, L.miniGrainR);\n\n    let minY = L.hopperBottom;\n    for (const g of this.hopperGrainCache) {\n      if (g.y < minY) minY = g.y;\n    }\n    this.hopperGrainTopY = minY;\n  }\n\n  bakeParticle(L: Layout, p: Particle): void {\n    const bin = p.bin;\n    this.binCounts[bin]++;\n    const count = this.binCounts[bin];\n\n    const binX = pegX(L, L.numRows - 1, bin);\n    const mr = L.miniGrainR;\n    const d = mr * 2.1;\n    const rowH = L.stackRowH;\n    const maxJitterX = Math.min(4, mr * 2.5);\n    const maxJitterY = rowH * 0.18;\n    const hexOff = (count % 2 === 0) ? d * 0.5 : 0;\n    const jx = stackJitterX(bin, count, maxJitterX);\n    const jy = stackJitterY(bin, count, maxJitterY);\n    const grainX = binX + hexOff + jx;\n    const grainY = L.accBottom - (count - 0.5) * rowH + jy;\n\n    const ctx = this.sCtx;\n    ctx.fillStyle = this.staticGrainFill;\n    ctx.beginPath();\n    ctx.arc(grainX, grainY, mr, 0, PI2);\n    ctx.fill();\n  }\n\n  rebakeStatic(L: Layout, _theme: ClockTheme): void {\n    if (!L) return;\n    this.sCtx.clearRect(0, 0, L.width, L.height);\n    const mr = L.miniGrainR;\n    const d = mr * 2.1;\n    const rowH = L.stackRowH;\n    const maxJitterX = Math.min(4, mr * 2.5);\n    const maxJitterY = rowH * 0.18;\n\n    this.sCtx.fillStyle = this.staticGrainFill;\n    this.sCtx.beginPath();\n    for (let bin = 0; bin <= L.numRows; bin++) {\n      const binX = pegX(L, L.numRows - 1, bin);\n      for (let k = 1; k <= this.binCounts[bin]; k++) {\n        const hexOff = (k % 2 === 0) ? d * 0.5 : 0;\n        const jx = stackJitterX(bin, k, maxJitterX);\n        const jy = stackJitterY(bin, k, maxJitterY);\n        const gx = binX + hexOff + jx;\n        const gy = L.accBottom - (k - 0.5) * rowH + jy;\n        this.sCtx.moveTo(gx + mr, gy);\n        this.sCtx.arc(gx, gy, mr, 0, PI2);\n      }\n    }\n    this.sCtx.fill();\n  }\n\n  drawHopper(\n    ctx: CanvasRenderingContext2D, L: Layout,\n    emitted: number, total: number,\n  ): void {\n    const cx = L.centerX;\n    ctx.save();\n    ctx.globalAlpha = this.hopperFadeAlpha;\n\n    // Funnel outline\n    const visTop = Math.max(0, L.hopperTop);\n    ctx.strokeStyle = 'rgba(255,255,255,0.08)';\n    ctx.lineWidth = 0.5;\n    const nSamples = 40;\n    ctx.beginPath();\n    for (let i = 0; i <= nSamples; i++) {\n      const y = visTop + (L.hopperBottom - visTop) * (i / nSamples);\n      const hw = gaussianHW(y, L);\n      if (i === 0) ctx.moveTo(cx + hw, y);\n      else ctx.lineTo(cx + hw, y);\n    }\n    for (let i = nSamples; i >= 0; i--) {\n      const y = visTop + (L.hopperBottom - visTop) * (i / nSamples);\n      const hw = gaussianHW(y, L);\n      ctx.lineTo(cx - hw, y);\n    }\n    ctx.closePath();\n    ctx.stroke();\n\n    // Grain fill\n    const remaining = Math.max(0, total - emitted);\n    const cacheLen = this.hopperGrainCache.length;\n\n    if (remaining > 0 && cacheLen > 0) {\n      const r = L.miniGrainR;\n      const ratio = remaining / total;\n      const progress = 1 - ratio;\n      const grainTop = this.hopperGrainTopY;\n      const grainH = L.hopperBottom - grainTop;\n\n      const volP = 1 - Math.pow(1 - progress, 1 / 3);\n      const centerDrop = volP * grainH * 1.1;\n      const edgeDrop = Math.pow(volP, 2.0) * grainH * 1.1;\n      const bowlDepth = centerDrop - edgeDrop;\n      const noiseAmp = r * 3.5;\n\n      ctx.fillStyle = this.grainGlowFill;\n      ctx.beginPath();\n      for (let i = 0; i < cacheLen; i++) {\n        const g = this.hopperGrainCache[i];\n        if (g.y < -r * 3) continue;\n        const localHW = gaussianHW(g.y, L);\n        const off = Math.min(1, Math.abs(g.x - cx) / localHW);\n        const noise = (((i * 2654435761) >>> 0) % 10000 / 10000 - 0.5) * noiseAmp;\n        const surfaceY = grainTop + edgeDrop + bowlDepth * (1 - off * off) + noise;\n        if (g.y < surfaceY) continue;\n        ctx.moveTo(g.x + r * GRAIN_GLOW_SCALE, g.y);\n        ctx.arc(g.x, g.y, r * GRAIN_GLOW_SCALE, 0, PI2);\n      }\n      ctx.fill();\n\n      ctx.fillStyle = this.grainCoreFill;\n      ctx.beginPath();\n      for (let i = 0; i < cacheLen; i++) {\n        const g = this.hopperGrainCache[i];\n        if (g.y < -r) continue;\n        const localHW = gaussianHW(g.y, L);\n        const off = Math.min(1, Math.abs(g.x - cx) / localHW);\n        const noise = (((i * 2654435761) >>> 0) % 10000 / 10000 - 0.5) * noiseAmp;\n        const surfaceY = grainTop + edgeDrop + bowlDepth * (1 - off * off) + noise;\n        if (g.y < surfaceY) continue;\n        ctx.moveTo(g.x + r, g.y);\n        ctx.arc(g.x, g.y, r, 0, PI2);\n      }\n      ctx.fill();\n    }\n\n    // Nozzle stream\n    if (remaining > 0) {\n      const now = performance.now();\n      const r = L.miniGrainR;\n      const streamCount = remaining < 10 ? Math.max(1, Math.ceil(remaining / 3)) : 4;\n      for (let i = 0; i < streamCount; i++) {\n        const phase = ((now * 0.003 + i * 0.25) % 1);\n        const sy = L.hopperBottom + (L.emitY - L.hopperBottom) * phase;\n        ctx.globalAlpha = 0.4 * (1 - phase * 0.8);\n        ctx.fillStyle = this.grainCoreFill;\n        ctx.beginPath();\n        ctx.arc(cx, sy, r * 0.7, 0, PI2);\n        ctx.fill();\n      }\n    }\n\n    ctx.restore();\n  }\n\n  drawPegs(ctx: CanvasRenderingContext2D, L: Layout, theme: ClockTheme, pegAlphaOverride?: number): void {\n    const [pr, pg, pb] = theme.segmentRGB;\n    const alpha = pegAlphaOverride !== undefined ? pegAlphaOverride : 0.15;\n    const themeWeight = (pegAlphaOverride !== undefined && pegAlphaOverride > 0.5) ? 0.6 : 0.3;\n    const grayWeight = 1 - themeWeight;\n    const blendR = Math.round(pr * themeWeight + 180 * grayWeight);\n    const blendG = Math.round(pg * themeWeight + 180 * grayWeight);\n    const blendB = Math.round(pb * themeWeight + 180 * grayWeight);\n    ctx.fillStyle = `rgba(${blendR},${blendG},${blendB},${alpha.toFixed(3)})`;\n    ctx.beginPath();\n    for (let row = 0; row < L.numRows; row++) {\n      for (let j = 0; j <= row; j++) {\n        const x = pegX(L, row, j);\n        const y = pegY(L, row);\n        ctx.moveTo(x + L.pegRadius, y);\n        ctx.arc(x, y, L.pegRadius, 0, PI2);\n      }\n    }\n    ctx.fill();\n  }\n\n  drawParticles(ctx: CanvasRenderingContext2D, L: Layout, particles: Particle[]): void {\n    if (particles.length === 0) return;\n    const r = L.grainRadius;\n\n    ctx.fillStyle = this.grainGlowFill;\n    ctx.beginPath();\n    for (const p of particles) {\n      ctx.moveTo(p.x + r * GRAIN_GLOW_SCALE, p.y);\n      ctx.arc(p.x, p.y, r * GRAIN_GLOW_SCALE, 0, PI2);\n    }\n    ctx.fill();\n\n    ctx.fillStyle = this.grainCoreFill;\n    ctx.beginPath();\n    for (const p of particles) {\n      ctx.moveTo(p.x + r, p.y);\n      ctx.arc(p.x, p.y, r, 0, PI2);\n    }\n    ctx.fill();\n  }\n\n  clearStatic(L: Layout): void {\n    this.binCounts.fill(0);\n    this.sCtx.clearRect(0, 0, L.width, L.height);\n  }\n\n  beginHopperFade(): void { this.hopperFadeAlpha = 1; }\n  setHopperFadeAlpha(a: number): void { this.hopperFadeAlpha = a; }\n  resetHopperFade(): void { this.hopperFadeAlpha = 1; }\n\n  fillStacks(L: Layout, numRows: number, totalParticles: number, theme: ClockTheme): void {\n    const n = numRows;\n    const numBins = n + 1;\n    this.binCounts = new Array(numBins).fill(0);\n\n    const lnFact: number[] = new Array(n + 1);\n    lnFact[0] = 0;\n    for (let i = 1; i <= n; i++) lnFact[i] = lnFact[i - 1] + Math.log(i);\n\n    const probs: number[] = new Array(numBins);\n    let placed = 0;\n    for (let k = 0; k < numBins; k++) {\n      probs[k] = Math.exp(lnFact[n] - lnFact[k] - lnFact[n - k] - n * Math.LN2);\n      this.binCounts[k] = Math.round(probs[k] * totalParticles);\n      placed += this.binCounts[k];\n    }\n    const centerBin = Math.floor(numBins / 2);\n    this.binCounts[centerBin] += totalParticles - placed;\n    this.rebakeStatic(L, theme);\n  }\n\n  getGroundY(L: Layout, x: number): number {\n    const numBins = L.numRows + 1;\n    let nearestBin = 0;\n    let minDist = Infinity;\n    for (let b = 0; b < numBins; b++) {\n      const bx = pegX(L, L.numRows - 1, b);\n      const dist = Math.abs(x - bx);\n      if (dist < minDist) { minDist = dist; nearestBin = b; }\n    }\n    return L.accBottom - this.binCounts[nearestBin] * L.stackRowH;\n  }\n}\n", "/**\n * AppRenderer for GALTON-TEMPO.\n * Adapted from GALTON-TIMER: BPM display instead of countdown, bar counter.\n */\n\nimport type { Particle, BoardGeom } from './simulation';\nimport { drawBPM, getThemeByName, CLOCK_THEMES } from './seven-seg';\nimport type { ClockTheme } from './seven-seg';\nimport { computeLayout, pegX, pegY } from './layout';\nimport type { Layout } from './layout';\nimport { GrainRenderer } from './grain-renderer';\n\nexport class Renderer {\n  layout!: Layout;\n  private gr: GrainRenderer;\n  private totalParticles: number;\n\n  private currentTheme: ClockTheme = CLOCK_THEMES[0];\n\n  constructor(\n    container: HTMLElement,\n    numRows: number,\n    totalParticles: number,\n  ) {\n    this.totalParticles = totalParticles;\n    this.gr = new GrainRenderer(container);\n    this.gr.updateGrainColors(this.currentTheme);\n    this.resize(numRows);\n  }\n\n  setTheme(theme: ClockTheme): void {\n    this.currentTheme = theme;\n    this.gr.updateGrainColors(theme);\n    const [r, g, b] = theme.segmentRGB;\n    document.documentElement.style.setProperty('--bg',\n      `rgb(${Math.round(r * 0.02)},${Math.round(g * 0.02)},${Math.round(b * 0.02)})`);\n    this.gr.rebakeStatic(this.layout, theme);\n  }\n\n  setThemeByName(name: string): void {\n    this.setTheme(getThemeByName(name));\n  }\n\n  getTheme(): ClockTheme {\n    return this.currentTheme;\n  }\n\n  resize(numRows: number, totalParticles?: number): void {\n    if (totalParticles !== undefined) this.totalParticles = totalParticles;\n    const dpr = window.devicePixelRatio || 1;\n    const w = window.innerWidth;\n    const h = window.innerHeight;\n    this.layout = computeLayout(w, h, dpr, numRows, this.totalParticles);\n    this.gr.applyLayout(this.layout, this.totalParticles);\n  }\n\n  pegX(row: number, index: number): number { return pegX(this.layout, row, index); }\n  pegY(row: number): number { return pegY(this.layout, row); }\n\n  getGeom(): BoardGeom {\n    return {\n      emitX: this.layout.centerX,\n      emitY: this.layout.emitY,\n      pegX: (r, i) => this.pegX(r, i),\n      pegY: (r) => this.pegY(r),\n      pegSpacing: this.layout.pegSpacing,\n      numRows: this.layout.numRows,\n      accBottom: this.layout.accBottom,\n    };\n  }\n\n  getGroundY(x: number): number {\n    return this.gr.getGroundY(this.layout, x);\n  }\n\n  bakeParticle(p: Particle): void {\n    this.gr.bakeParticle(this.layout, p);\n  }\n\n  drawFrame(\n    particles: Particle[],\n    bpm: number,\n    totalParticles: number,\n    emittedCount: number,\n    currentBar: number,\n    totalBars: number,\n    beatInBar: number,\n  ): void {\n    const L = this.layout;\n    const ctx = this.gr.dCtx;\n    ctx.clearRect(0, 0, L.width, L.height);\n\n    // Progress bar\n    if (totalParticles > 0) {\n      const progress = Math.min(1, emittedCount / totalParticles);\n      const [r, g, b] = this.currentTheme.segmentRGB;\n      ctx.fillStyle = `rgba(${r},${g},${b},0.60)`;\n      ctx.fillRect(0, 0, L.width * progress, 2);\n    }\n\n    // BPM display (large, center)\n    const digitH = Math.min(L.width * 0.22, L.height * 0.25);\n    drawBPM(ctx, bpm, L.centerX, L.height / 2, digitH, this.currentTheme);\n\n    // \"BPM\" label below digits\n    const [lr, lg, lb] = this.currentTheme.segmentRGB;\n    ctx.fillStyle = `rgba(${lr},${lg},${lb},0.25)`;\n    ctx.font = `400 ${Math.max(10, digitH * 0.12)}px \"JetBrains Mono\", monospace`;\n    ctx.textAlign = 'center';\n    ctx.fillText('BPM', L.centerX, L.height / 2 + digitH / 2 + digitH * 0.15);\n\n    // Bar counter (inline, above hopper)\n    const barText = `BAR ${currentBar + 1} / ${totalBars}`;\n    ctx.fillStyle = `rgba(${lr},${lg},${lb},0.35)`;\n    ctx.font = `500 ${Math.max(10, L.height * 0.018)}px \"JetBrains Mono\", monospace`;\n    ctx.textAlign = 'center';\n    ctx.fillText(barText, L.centerX, L.inlineTimerY);\n\n    // Beat indicator dots (4 dots, current one highlighted)\n    const dotY = L.inlineTimerY + L.height * 0.025;\n    const dotR = Math.max(2, L.height * 0.004);\n    const dotGap = dotR * 4;\n    const dotsStartX = L.centerX - (3 * dotGap) / 2;\n    for (let i = 0; i < 4; i++) {\n      const dx = dotsStartX + i * dotGap;\n      const isActive = i === beatInBar;\n      ctx.fillStyle = isActive\n        ? `rgba(${lr},${lg},${lb},0.9)`\n        : `rgba(${lr},${lg},${lb},0.15)`;\n      ctx.beginPath();\n      ctx.arc(dx, dotY, isActive ? dotR * 1.3 : dotR, 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    // Hopper\n    this.gr.drawHopper(ctx, L, emittedCount, totalParticles);\n\n    // Pegs\n    this.gr.drawPegs(ctx, L, this.currentTheme);\n\n    // Moving particles\n    this.gr.drawParticles(ctx, L, particles);\n  }\n\n  clearStatic(): void {\n    this.gr.clearStatic(this.layout);\n  }\n\n  fillStacks(numRows: number, totalParticles: number): void {\n    this.gr.fillStacks(this.layout, numRows, totalParticles, this.currentTheme);\n  }\n\n  beginHopperFade(): void { this.gr.beginHopperFade(); }\n  setHopperFadeAlpha(a: number): void { this.gr.setHopperFadeAlpha(a); }\n  resetHopperFade(): void { this.gr.resetHopperFade(); }\n}\n\nexport { CLOCK_THEMES, getThemeByName };\nexport type { ClockTheme, Layout };\n", "/**\n * Timer Bridge \u2014 wraps the Web Worker timer for main-thread use.\n */\n\nexport class TimerBridge {\n  private worker: Worker;\n  onTick: ((remainingMs: number, elapsedMs: number) => void) | null = null;\n  onDone: (() => void) | null = null;\n\n  constructor() {\n    this.worker = new Worker('dist/timer-worker.js');\n    this.worker.onmessage = (e: MessageEvent) => {\n      const msg = e.data;\n      if (msg.type === 'TICK') {\n        this.onTick?.(msg.remainingMs, msg.elapsedMs);\n      } else if (msg.type === 'DONE') {\n        this.onDone?.();\n      }\n    };\n  }\n\n  start(totalMs: number): void {\n    this.worker.postMessage({\n      type: 'START',\n      totalMs,\n      startAbsMs: performance.now(),\n    });\n  }\n\n  addTime(addMs: number): void {\n    this.worker.postMessage({ type: 'ADD_TIME', addMs });\n  }\n\n  pause(): void {\n    this.worker.postMessage({ type: 'PAUSE' });\n  }\n\n  resume(): void {\n    this.worker.postMessage({\n      type: 'RESUME',\n      resumeAbsMs: performance.now(),\n    });\n  }\n\n  reset(): void {\n    this.worker.postMessage({ type: 'RESET' });\n  }\n}\n", "/**\n * AudioEngine \u2014 Web Audio synthesis for GALTON-TEMPO.\n *\n * Sound types:\n *   1. Click: short noise burst (metronome wood block)\n *   2. Kick:  low sine with pitch envelope\n *   3. Peg hit: short metallic ping (pitch varies by position)\n */\n\nexport type SoundType = 'click' | 'kick' | 'both';\n\nexport class AudioEngine {\n  private ctx: AudioContext | null = null;\n  private masterGain: GainNode | null = null;\n  soundType: SoundType = 'click';\n\n  /** Must be called after a user gesture (tap/click). */\n  async ensureContext(): Promise<void> {\n    if (!this.ctx) {\n      this.ctx = new AudioContext();\n      this.masterGain = this.ctx.createGain();\n      this.masterGain.gain.value = 0.7;\n      this.masterGain.connect(this.ctx.destination);\n    }\n    if (this.ctx.state === 'suspended') {\n      await this.ctx.resume();\n    }\n  }\n\n  /** Play metronome beat. accent = true for beat 1 of bar. */\n  playBeat(accent: boolean): void {\n    if (!this.ctx || !this.masterGain) return;\n    const now = this.ctx.currentTime;\n\n    if (this.soundType === 'click' || this.soundType === 'both') {\n      this.playClick(now, accent);\n    }\n    if (this.soundType === 'kick' || this.soundType === 'both') {\n      this.playKick(now, accent);\n    }\n  }\n\n  /** Play peg collision sound. Pitch mapped from row/col position. */\n  playPegHit(row: number, col: number, numRows: number): void {\n    if (!this.ctx || !this.masterGain) return;\n    const now = this.ctx.currentTime;\n\n    // Map row to frequency: higher rows = higher pitch\n    // Range: ~200Hz (row 0) to ~2000Hz (last row)\n    const rowFrac = row / Math.max(1, numRows - 1);\n    const freq = 200 + rowFrac * 1800;\n\n    // Slight pan based on column position\n    const colFrac = numRows > 0 ? (col / row - 0.5) * 2 : 0;\n\n    const osc = this.ctx.createOscillator();\n    osc.type = 'triangle';\n    osc.frequency.value = freq;\n\n    const gain = this.ctx.createGain();\n    gain.gain.setValueAtTime(0.03, now);\n    gain.gain.exponentialRampToValueAtTime(0.001, now + 0.04);\n\n    // Pan\n    const pan = this.ctx.createStereoPanner();\n    pan.pan.value = Math.max(-1, Math.min(1, colFrac * 0.6));\n\n    osc.connect(gain);\n    gain.connect(pan);\n    pan.connect(this.masterGain!);\n\n    osc.start(now);\n    osc.stop(now + 0.05);\n  }\n\n  private playClick(time: number, accent: boolean): void {\n    const ctx = this.ctx!;\n\n    // Short oscillator burst (wood block style)\n    const osc = ctx.createOscillator();\n    osc.type = 'sine';\n    osc.frequency.value = accent ? 1500 : 1000;\n\n    const gain = ctx.createGain();\n    const vol = accent ? 0.5 : 0.3;\n    gain.gain.setValueAtTime(vol, time);\n    gain.gain.exponentialRampToValueAtTime(0.001, time + 0.03);\n\n    // High-pass for click character\n    const hp = ctx.createBiquadFilter();\n    hp.type = 'highpass';\n    hp.frequency.value = 600;\n\n    osc.connect(hp);\n    hp.connect(gain);\n    gain.connect(this.masterGain!);\n\n    osc.start(time);\n    osc.stop(time + 0.04);\n  }\n\n  private playKick(time: number, accent: boolean): void {\n    const ctx = this.ctx!;\n\n    // Sine with pitch envelope: 150Hz \u2192 30Hz\n    const osc = ctx.createOscillator();\n    osc.type = 'sine';\n    osc.frequency.setValueAtTime(accent ? 160 : 120, time);\n    osc.frequency.exponentialRampToValueAtTime(30, time + 0.12);\n\n    const gain = ctx.createGain();\n    const vol = accent ? 0.6 : 0.4;\n    gain.gain.setValueAtTime(vol, time);\n    gain.gain.exponentialRampToValueAtTime(0.001, time + 0.25);\n\n    osc.connect(gain);\n    gain.connect(this.masterGain!);\n\n    osc.start(time);\n    osc.stop(time + 0.3);\n  }\n}\n", "/**\n * Control Console for GALTON-TEMPO.\n * Simplified from GALTON-TIMER: BPM control, bars, sound type, theme.\n */\n\nimport { PRESETS, PHYSICS, PhysicsParams } from '../engine/simulation';\nimport { CLOCK_THEMES } from '../engine/seven-seg';\nimport type { SoundType } from '../engine/audio';\n\nexport interface ConsoleController {\n  el: HTMLElement;\n  show(): void;\n  hide(): void;\n  onStart: (() => void) | null;\n  onPause: (() => void) | null;\n  onStop: (() => void) | null;\n  onBpmChange: ((bpm: number) => void) | null;\n  onBarsChange: ((bars: number) => void) | null;\n  onSoundChange: ((sound: SoundType) => void) | null;\n  onThemeChange: ((name: string) => void) | null;\n  onModeChange: ((mode: string) => void) | null;\n  onShareURL: (() => void) | null;\n  onResetDefaults: (() => void) | null;\n  setPaused(paused: boolean): void;\n  setThemeName(name: string): void;\n  setAccentColor(rgb: [number, number, number]): void;\n  setBpm(bpm: number): void;\n  setBars(bars: number): void;\n  setConfigEnabled(enabled: boolean): void;\n  closeDrawer(): void;\n}\n\nfunction injectStyles(): void {\n  if (document.getElementById('gt-console-style')) return;\n  const style = document.createElement('style');\n  style.id = 'gt-console-style';\n  style.textContent = `\n    .gt-controls {\n      position: fixed; bottom: 28px; left: 50%; transform: translateX(-50%);\n      z-index: 1000; display: flex; gap: 20px; align-items: center;\n      user-select: none; transition: opacity 0.4s ease;\n    }\n    .gt-controls.hidden { opacity: 0; pointer-events: none; }\n    .gt-ctrl-btn {\n      width: 36px; height: 36px; border-radius: 50%;\n      border: 1.5px solid rgba(255,255,255,0.12);\n      background: transparent; color: rgba(255,255,255,0.45);\n      font-size: 14px; display: flex; align-items: center; justify-content: center;\n      cursor: pointer; transition: background 0.2s, color 0.2s, border-color 0.2s;\n      padding: 0; line-height: 1;\n    }\n    .gt-ctrl-btn:hover { background: rgba(255,255,255,0.04); color: rgba(255,255,255,0.80); border-color: rgba(255,255,255,0.25); }\n    .gt-ctrl-btn:active { background: rgba(255,255,255,0.14); }\n    .gt-ctrl-btn svg { width: 18px; height: 18px; fill: currentColor; }\n\n    .gt-drawer-overlay {\n      position: fixed; inset: 0; z-index: 600;\n      background: rgba(0,0,0,0.35); opacity: 0; pointer-events: none;\n      transition: opacity 0.3s ease;\n    }\n    .gt-drawer-overlay.open { opacity: 1; pointer-events: auto; }\n    .gt-drawer {\n      position: fixed; top: 0; right: 0; bottom: 0; width: 300px; max-width: 82vw;\n      z-index: 601; background: rgba(8,8,12,0.72);\n      border-left: 1px solid rgba(255,255,255,0.05);\n      backdrop-filter: blur(32px) saturate(1.4);\n      -webkit-backdrop-filter: blur(32px) saturate(1.4);\n      transform: translateX(100%);\n      transition: transform 0.35s cubic-bezier(0.4,0,0.2,1);\n      display: flex; flex-direction: column;\n      font-family: 'JetBrains Mono', 'SF Mono', 'Menlo', monospace;\n      overflow-y: auto; scrollbar-width: thin; scrollbar-color: rgba(255,255,255,0.06) transparent;\n    }\n    .gt-drawer.open { transform: translateX(0); }\n    .gt-drawer-content { padding: 40px 28px 32px; display: flex; flex-direction: column; gap: 36px; }\n\n    .gt-section-title {\n      font-size: 10px; font-weight: 700; letter-spacing: 4px; text-transform: uppercase;\n      color: rgba(255,255,255,0.25); margin-bottom: 20px; padding-bottom: 8px;\n      border-bottom: 1px solid rgba(255,255,255,0.04);\n    }\n    .gt-section { display: flex; flex-direction: column; }\n\n    .gt-field-row { display: flex; align-items: center; justify-content: space-between; gap: 12px; min-height: 36px; margin-bottom: 4px; }\n    .gt-field-label { font-size: 11px; font-weight: 400; color: rgba(255,255,255,0.40); flex-shrink: 0; letter-spacing: 0.5px; }\n    .gt-field-select {\n      flex: 1; max-width: 150px; padding: 6px 10px;\n      background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);\n      border-radius: 6px; color: rgba(255,255,255,0.60);\n      font-family: inherit; font-size: 11px; outline: none; cursor: pointer;\n    }\n    .gt-field-select option { background: #0c0c0e; color: #bbb; }\n\n    .gt-slider-input {\n      -webkit-appearance: none; appearance: none; flex: 1; height: 2px;\n      background: rgba(255,255,255,0.08); border-radius: 1px; outline: none; cursor: pointer;\n    }\n    .gt-slider-input::-webkit-slider-thumb {\n      -webkit-appearance: none; appearance: none; width: 12px; height: 12px;\n      border-radius: 50%; background: rgba(255,255,255,0.40); cursor: pointer;\n    }\n    .gt-slider-input::-moz-range-thumb {\n      width: 12px; height: 12px; border-radius: 50%;\n      background: rgba(255,255,255,0.40); cursor: pointer; border: none;\n    }\n\n    .gt-dur-row { display: flex; align-items: center; gap: 8px; min-height: 36px; margin-bottom: 4px; }\n    .gt-dur-btn {\n      width: 30px; height: 30px; border-radius: 50%;\n      border: 1px solid rgba(255,255,255,0.08); background: transparent;\n      color: rgba(255,255,255,0.35); font-size: 16px; font-family: inherit;\n      display: flex; align-items: center; justify-content: center;\n      cursor: pointer; user-select: none; flex-shrink: 0; transition: all 0.15s;\n    }\n    .gt-dur-btn:hover { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.70); border-color: rgba(255,255,255,0.15); }\n    .gt-dur-display {\n      width: 56px; padding: 0; background: transparent; border: none;\n      color: rgba(255,255,255,0.70); font-family: inherit; font-size: 14px;\n      font-weight: 500; letter-spacing: 1.5px; outline: none; text-align: center;\n      flex-shrink: 0; caret-color: rgba(255,255,255,0.40);\n    }\n\n    .gt-preset-row { display: flex; gap: 6px; margin-bottom: 8px; }\n    .gt-preset-btn {\n      flex: 1; padding: 4px 0; border: 1px solid transparent; border-radius: 4px;\n      background: rgba(255,255,255,0.03); color: rgba(255,255,255,0.28);\n      font-size: 11px; font-family: monospace; cursor: pointer; min-height: 26px;\n      transition: all 0.2s;\n    }\n    .gt-preset-btn:hover { background: rgba(255,255,255,0.07); color: rgba(255,255,255,0.55); }\n    .gt-preset-btn.active {\n      border-color: var(--accent, rgba(255,255,255,0.30));\n      color: var(--accent, rgba(255,255,255,0.80));\n      background: color-mix(in srgb, var(--accent, #fff) 8%, transparent);\n      box-shadow: 0 0 6px color-mix(in srgb, var(--accent, #fff) 15%, transparent);\n    }\n    .gt-preset-btn:disabled { opacity: 0.3; cursor: default; }\n\n    .gt-dur-hint {\n      font-size: 10px; color: rgba(255,160,60,0.7); letter-spacing: 0.5px;\n      margin-left: auto; animation: gt-hint-pulse 2s ease-in-out infinite;\n    }\n    @keyframes gt-hint-pulse { 0%, 100% { opacity: 0.7; } 50% { opacity: 1.0; } }\n\n    .gt-theme-strip { display: flex; gap: 0; margin-bottom: 4px; border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05); }\n    .gt-theme-chip {\n      flex: 1; display: flex; align-items: center; justify-content: center; gap: 5px;\n      padding: 10px 0; font-size: 8.5px; font-weight: 500; letter-spacing: 0.8px;\n      text-transform: uppercase; font-family: inherit;\n      color: rgba(255,255,255,0.30); background: rgba(255,255,255,0.02);\n      border: none; border-right: 1px solid rgba(255,255,255,0.04);\n      cursor: pointer; transition: all 0.25s;\n    }\n    .gt-theme-chip:last-child { border-right: none; }\n    .gt-theme-chip .gt-led { width: 4px; height: 4px; border-radius: 50%; flex-shrink: 0; opacity: 0.45; transition: opacity 0.25s, box-shadow 0.25s; }\n    .gt-theme-chip:hover { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.55); }\n    .gt-theme-chip:hover .gt-led { opacity: 0.7; }\n    .gt-theme-chip.active { color: rgba(255,255,255,0.85); background: color-mix(in srgb, var(--tc) 6%, transparent); box-shadow: inset 0 0 12px color-mix(in srgb, var(--tc) 8%, transparent); }\n    .gt-theme-chip.active .gt-led { opacity: 1; box-shadow: 0 0 4px var(--tc), 0 0 8px color-mix(in srgb, var(--tc) 50%, transparent); }\n\n    .gt-sys-btn {\n      width: 100%; padding: 10px 0; background: rgba(255,255,255,0.02);\n      border: 1px solid rgba(255,255,255,0.05); border-radius: 8px;\n      color: rgba(255,255,255,0.35); font-family: inherit; font-size: 10px;\n      font-weight: 500; letter-spacing: 1px; text-transform: uppercase;\n      cursor: pointer; transition: all 0.15s; margin-bottom: 8px;\n    }\n    .gt-sys-btn:hover { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.60); border-color: rgba(255,255,255,0.10); }\n\n    .gt-credits {\n      position: fixed; bottom: 8px; left: 50%; transform: translateX(-50%);\n      font-size: 9px; color: rgba(255,255,255,0.12); letter-spacing: 1.5px;\n      z-index: 1; pointer-events: none; font-family: 'JetBrains Mono', 'SF Mono', monospace;\n    }\n  `;\n  document.head.appendChild(style);\n}\n\nfunction makeHold(setter: (d: number) => void) {\n  let iv: ReturnType<typeof setInterval> | null = null;\n  return {\n    start(d: number) { setter(d); iv = setInterval(() => setter(d), 80); },\n    stop() { if (iv) { clearInterval(iv); iv = null; } },\n  };\n}\n\nexport function createConsole(\n  initialBpm: number,\n  initialBars: number,\n  initialTheme: string,\n  initialSound: SoundType,\n  initialMode: string,\n): ConsoleController {\n  injectStyles();\n\n  let currentBpm = initialBpm;\n  let currentBars = initialBars;\n\n  // Credits\n  const creditsEl = document.createElement('div');\n  creditsEl.className = 'gt-credits';\n  creditsEl.textContent = 'Crafted by Tipsy Tap Studio';\n  document.body.appendChild(creditsEl);\n\n  // \u2500\u2500 On-screen controls \u2500\u2500\n  const controls = document.createElement('div');\n  controls.className = 'gt-controls';\n\n  function makeBtn(svg: string, title: string): HTMLButtonElement {\n    const btn = document.createElement('button');\n    btn.className = 'gt-ctrl-btn';\n    btn.innerHTML = svg;\n    btn.title = title;\n    return btn;\n  }\n\n  const startBtn = makeBtn('<svg viewBox=\"0 0 24 24\"><polygon points=\"6,4 20,12 6,20\"/></svg>', 'Start');\n  const pauseBtn = makeBtn('<svg viewBox=\"0 0 24 24\"><rect x=\"5\" y=\"4\" width=\"4\" height=\"16\"/><rect x=\"15\" y=\"4\" width=\"4\" height=\"16\"/></svg>', 'Pause');\n  const stopBtn = makeBtn('<svg viewBox=\"0 0 24 24\"><rect x=\"5\" y=\"5\" width=\"14\" height=\"14\" rx=\"2\"/></svg>', 'Stop');\n  const settingsBtn = makeBtn('<svg viewBox=\"0 0 24 24\"><path d=\"M12 15.5A3.5 3.5 0 1 0 12 8.5a3.5 3.5 0 0 0 0 7z\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"/><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"/></svg>', 'Settings');\n\n  startBtn.addEventListener('click', () => ctrl.onStart?.());\n  pauseBtn.addEventListener('click', () => ctrl.onPause?.());\n  stopBtn.addEventListener('click', () => ctrl.onStop?.());\n  settingsBtn.addEventListener('click', () => toggleDrawer());\n\n  controls.appendChild(startBtn);\n  controls.appendChild(pauseBtn);\n  controls.appendChild(stopBtn);\n  controls.appendChild(settingsBtn);\n  document.body.appendChild(controls);\n\n  // \u2500\u2500 Drawer \u2500\u2500\n  const overlay = document.createElement('div');\n  overlay.className = 'gt-drawer-overlay';\n  overlay.addEventListener('click', () => closeDrawer());\n\n  const drawer = document.createElement('div');\n  drawer.className = 'gt-drawer';\n  const drawerContent = document.createElement('div');\n  drawerContent.className = 'gt-drawer-content';\n\n  // \u2500\u2500 TEMPO section \u2500\u2500\n  const tempoSection = document.createElement('div');\n  tempoSection.className = 'gt-section';\n  tempoSection.innerHTML = '<div class=\"gt-section-title\">Tempo</div>';\n\n  // BPM\n  const bpmLabel = document.createElement('div');\n  bpmLabel.className = 'gt-field-row';\n  bpmLabel.innerHTML = '<span class=\"gt-field-label\">BPM</span>';\n  bpmLabel.style.marginBottom = '0';\n  const bpmHint = document.createElement('span');\n  bpmHint.className = 'gt-dur-hint';\n  bpmHint.textContent = 'Stop to change';\n  bpmHint.style.display = 'none';\n  bpmLabel.appendChild(bpmHint);\n\n  const bpmPresetRow = document.createElement('div');\n  bpmPresetRow.className = 'gt-preset-row';\n  const BPM_PRESETS = [\n    { label: '60', val: 60 },\n    { label: '90', val: 90 },\n    { label: '120', val: 120 },\n    { label: '140', val: 140 },\n    { label: '160', val: 160 },\n  ];\n  const bpmPresetBtns: HTMLButtonElement[] = [];\n  for (const p of BPM_PRESETS) {\n    const btn = document.createElement('button');\n    btn.className = 'gt-preset-btn';\n    btn.textContent = p.label;\n    if (p.val === currentBpm) btn.classList.add('active');\n    btn.addEventListener('click', () => {\n      setBpmVal(p.val);\n      bpmPresetBtns.forEach(b => b.classList.remove('active'));\n      btn.classList.add('active');\n    });\n    bpmPresetRow.appendChild(btn);\n    bpmPresetBtns.push(btn);\n  }\n\n  const bpmRow = document.createElement('div');\n  bpmRow.className = 'gt-dur-row';\n  const bpmMinusBtn = document.createElement('button');\n  bpmMinusBtn.className = 'gt-dur-btn';\n  bpmMinusBtn.textContent = '\\u2212';\n  const bpmSlider = document.createElement('input');\n  bpmSlider.type = 'range';\n  bpmSlider.className = 'gt-slider-input';\n  bpmSlider.min = '20';\n  bpmSlider.max = '300';\n  bpmSlider.step = '1';\n  bpmSlider.value = String(currentBpm);\n  bpmSlider.style.flex = '1';\n  const bpmDisplay = document.createElement('input');\n  bpmDisplay.className = 'gt-dur-display';\n  bpmDisplay.type = 'text';\n  bpmDisplay.value = String(currentBpm);\n  const bpmPlusBtn = document.createElement('button');\n  bpmPlusBtn.className = 'gt-dur-btn';\n  bpmPlusBtn.textContent = '+';\n\n  function setBpmVal(v: number): void {\n    v = Math.max(20, Math.min(300, v));\n    currentBpm = v;\n    bpmSlider.value = String(v);\n    bpmDisplay.value = String(v);\n    ctrl.onBpmChange?.(v);\n  }\n\n  bpmSlider.addEventListener('input', () => {\n    const v = parseInt(bpmSlider.value, 10);\n    currentBpm = v;\n    bpmDisplay.value = String(v);\n    bpmPresetBtns.forEach(b => b.classList.remove('active'));\n    ctrl.onBpmChange?.(v);\n  });\n  bpmDisplay.addEventListener('change', () => {\n    const v = parseInt(bpmDisplay.value, 10);\n    if (Number.isFinite(v)) setBpmVal(v);\n    else bpmDisplay.value = String(currentBpm);\n  });\n\n  const bpmHold = makeHold((d) => setBpmVal(currentBpm + d));\n  bpmMinusBtn.addEventListener('pointerdown', (e) => { e.preventDefault(); bpmHold.start(-1); });\n  bpmMinusBtn.addEventListener('pointerup', () => bpmHold.stop());\n  bpmMinusBtn.addEventListener('pointerleave', () => bpmHold.stop());\n  bpmPlusBtn.addEventListener('pointerdown', (e) => { e.preventDefault(); bpmHold.start(1); });\n  bpmPlusBtn.addEventListener('pointerup', () => bpmHold.stop());\n  bpmPlusBtn.addEventListener('pointerleave', () => bpmHold.stop());\n\n  bpmRow.appendChild(bpmMinusBtn);\n  bpmRow.appendChild(bpmSlider);\n  bpmRow.appendChild(bpmDisplay);\n  bpmRow.appendChild(bpmPlusBtn);\n\n  tempoSection.appendChild(bpmLabel);\n  tempoSection.appendChild(bpmPresetRow);\n  tempoSection.appendChild(bpmRow);\n\n  // Bars\n  const barsLabel = document.createElement('div');\n  barsLabel.className = 'gt-field-row';\n  barsLabel.innerHTML = '<span class=\"gt-field-label\">Bars</span>';\n  barsLabel.style.marginBottom = '0';\n  const barsHint = document.createElement('span');\n  barsHint.className = 'gt-dur-hint';\n  barsHint.textContent = 'Stop to change';\n  barsHint.style.display = 'none';\n  barsLabel.appendChild(barsHint);\n\n  const barsPresetRow = document.createElement('div');\n  barsPresetRow.className = 'gt-preset-row';\n  const BARS_PRESETS = [\n    { label: '4', val: 4 },\n    { label: '8', val: 8 },\n    { label: '16', val: 16 },\n    { label: '32', val: 32 },\n    { label: '64', val: 64 },\n  ];\n  const barsPresetBtns: HTMLButtonElement[] = [];\n  for (const p of BARS_PRESETS) {\n    const btn = document.createElement('button');\n    btn.className = 'gt-preset-btn';\n    btn.textContent = p.label;\n    if (p.val === currentBars) btn.classList.add('active');\n    btn.addEventListener('click', () => {\n      setBarsVal(p.val);\n      barsPresetBtns.forEach(b => b.classList.remove('active'));\n      btn.classList.add('active');\n    });\n    barsPresetRow.appendChild(btn);\n    barsPresetBtns.push(btn);\n  }\n\n  const barsRow = document.createElement('div');\n  barsRow.className = 'gt-dur-row';\n  const barsMinusBtn = document.createElement('button');\n  barsMinusBtn.className = 'gt-dur-btn';\n  barsMinusBtn.textContent = '\\u2212';\n  const barsSlider = document.createElement('input');\n  barsSlider.type = 'range';\n  barsSlider.className = 'gt-slider-input';\n  barsSlider.min = '1';\n  barsSlider.max = '128';\n  barsSlider.step = '1';\n  barsSlider.value = String(currentBars);\n  barsSlider.style.flex = '1';\n  const barsDisplay = document.createElement('input');\n  barsDisplay.className = 'gt-dur-display';\n  barsDisplay.type = 'text';\n  barsDisplay.value = String(currentBars);\n  const barsPlusBtn = document.createElement('button');\n  barsPlusBtn.className = 'gt-dur-btn';\n  barsPlusBtn.textContent = '+';\n\n  function setBarsVal(v: number): void {\n    v = Math.max(1, Math.min(999, v));\n    currentBars = v;\n    barsSlider.value = String(Math.min(128, v));\n    barsDisplay.value = String(v);\n    ctrl.onBarsChange?.(v);\n  }\n\n  barsSlider.addEventListener('input', () => {\n    const v = parseInt(barsSlider.value, 10);\n    currentBars = v;\n    barsDisplay.value = String(v);\n    barsPresetBtns.forEach(b => b.classList.remove('active'));\n    ctrl.onBarsChange?.(v);\n  });\n  barsDisplay.addEventListener('change', () => {\n    const v = parseInt(barsDisplay.value, 10);\n    if (Number.isFinite(v)) setBarsVal(v);\n    else barsDisplay.value = String(currentBars);\n  });\n\n  const barsHold = makeHold((d) => setBarsVal(currentBars + d));\n  barsMinusBtn.addEventListener('pointerdown', (e) => { e.preventDefault(); barsHold.start(-1); });\n  barsMinusBtn.addEventListener('pointerup', () => barsHold.stop());\n  barsMinusBtn.addEventListener('pointerleave', () => barsHold.stop());\n  barsPlusBtn.addEventListener('pointerdown', (e) => { e.preventDefault(); barsHold.start(1); });\n  barsPlusBtn.addEventListener('pointerup', () => barsHold.stop());\n  barsPlusBtn.addEventListener('pointerleave', () => barsHold.stop());\n\n  barsRow.appendChild(barsMinusBtn);\n  barsRow.appendChild(barsSlider);\n  barsRow.appendChild(barsDisplay);\n  barsRow.appendChild(barsPlusBtn);\n\n  tempoSection.appendChild(barsLabel);\n  tempoSection.appendChild(barsPresetRow);\n  tempoSection.appendChild(barsRow);\n\n  // Sound type\n  const soundRow = document.createElement('div');\n  soundRow.className = 'gt-field-row';\n  soundRow.innerHTML = '<span class=\"gt-field-label\">Sound</span>';\n  const soundSelect = document.createElement('select');\n  soundSelect.className = 'gt-field-select';\n  for (const [val, label] of [['click', 'Click'], ['kick', 'Kick'], ['both', 'Both']] as const) {\n    const opt = document.createElement('option');\n    opt.value = val;\n    opt.textContent = label;\n    if (val === initialSound) opt.selected = true;\n    soundSelect.appendChild(opt);\n  }\n  soundSelect.addEventListener('change', () => {\n    ctrl.onSoundChange?.(soundSelect.value as SoundType);\n  });\n  soundRow.appendChild(soundSelect);\n  tempoSection.appendChild(soundRow);\n\n  // Physics preset\n  const presetRow = document.createElement('div');\n  presetRow.className = 'gt-field-row';\n  presetRow.innerHTML = '<span class=\"gt-field-label\">Physics</span>';\n  const presetSelect = document.createElement('select');\n  presetSelect.className = 'gt-field-select';\n  for (const name of Object.keys(PRESETS)) {\n    const opt = document.createElement('option');\n    opt.value = name.toLowerCase();\n    opt.textContent = name;\n    if (name.toLowerCase() === initialMode.toLowerCase()) opt.selected = true;\n    presetSelect.appendChild(opt);\n  }\n  presetSelect.addEventListener('change', () => {\n    ctrl.onModeChange?.(presetSelect.value);\n  });\n  presetRow.appendChild(presetSelect);\n  tempoSection.appendChild(presetRow);\n\n  drawerContent.appendChild(tempoSection);\n\n  // \u2500\u2500 THEME section \u2500\u2500\n  const themeSection = document.createElement('div');\n  themeSection.className = 'gt-section';\n  themeSection.innerHTML = '<div class=\"gt-section-title\">Theme</div>';\n\n  const themeStrip = document.createElement('div');\n  themeStrip.className = 'gt-theme-strip';\n  const themeChips: HTMLButtonElement[] = [];\n\n  const LED_COLORS: Record<string, string> = {\n    nixie: '#FF8C00', system: '#00FF41', studio: '#FFFFFF', cyber: '#00D1FF',\n  };\n\n  for (const t of CLOCK_THEMES) {\n    const chip = document.createElement('button');\n    chip.className = 'gt-theme-chip';\n    const tc = LED_COLORS[t.name.toLowerCase()] || '#fff';\n    chip.style.setProperty('--tc', tc);\n    if (t.name.toLowerCase() === initialTheme.toLowerCase()) chip.classList.add('active');\n\n    const led = document.createElement('span');\n    led.className = 'gt-led';\n    led.style.background = tc;\n    chip.appendChild(led);\n    const label = document.createElement('span');\n    label.textContent = t.name;\n    chip.appendChild(label);\n\n    chip.addEventListener('click', () => {\n      themeChips.forEach(c => c.classList.remove('active'));\n      chip.classList.add('active');\n      ctrl.onThemeChange?.(t.name);\n    });\n    themeStrip.appendChild(chip);\n    themeChips.push(chip);\n  }\n  themeSection.appendChild(themeStrip);\n  drawerContent.appendChild(themeSection);\n\n  // \u2500\u2500 SYSTEM section \u2500\u2500\n  const sysSection = document.createElement('div');\n  sysSection.className = 'gt-section';\n  sysSection.innerHTML = '<div class=\"gt-section-title\">System</div>';\n\n  const shareBtn = document.createElement('button');\n  shareBtn.className = 'gt-sys-btn';\n  shareBtn.textContent = 'Share URL';\n  shareBtn.addEventListener('click', () => {\n    ctrl.onShareURL?.();\n    shareBtn.textContent = 'Copied!';\n    setTimeout(() => { shareBtn.textContent = 'Share URL'; }, 1500);\n  });\n  sysSection.appendChild(shareBtn);\n\n  const resetBtn = document.createElement('button');\n  resetBtn.className = 'gt-sys-btn';\n  resetBtn.textContent = 'Reset to Default';\n  resetBtn.addEventListener('click', () => ctrl.onResetDefaults?.());\n  sysSection.appendChild(resetBtn);\n\n  drawerContent.appendChild(sysSection);\n\n  drawer.appendChild(drawerContent);\n  document.body.appendChild(overlay);\n  document.body.appendChild(drawer);\n\n  // \u2500\u2500 Drawer toggle \u2500\u2500\n  let drawerOpen = false;\n  function toggleDrawer(): void {\n    drawerOpen = !drawerOpen;\n    drawer.classList.toggle('open', drawerOpen);\n    overlay.classList.toggle('open', drawerOpen);\n  }\n  function closeDrawer(): void {\n    drawerOpen = false;\n    drawer.classList.remove('open');\n    overlay.classList.remove('open');\n  }\n\n  // \u2500\u2500 Controller \u2500\u2500\n  const ctrl: ConsoleController = {\n    el: controls,\n    show() { controls.classList.remove('hidden'); },\n    hide() { controls.classList.add('hidden'); if (drawerOpen) closeDrawer(); },\n    onStart: null, onPause: null, onStop: null,\n    onBpmChange: null, onBarsChange: null, onSoundChange: null,\n    onThemeChange: null, onModeChange: null, onShareURL: null, onResetDefaults: null,\n    setPaused(p: boolean) {\n      startBtn.style.display = p ? '' : 'none';\n      pauseBtn.style.display = p ? 'none' : '';\n    },\n    setThemeName(name: string) {\n      themeChips.forEach(c => {\n        c.classList.toggle('active', c.textContent?.toLowerCase() === name.toLowerCase());\n      });\n    },\n    setAccentColor(rgb: [number, number, number]) {\n      const [r, g, b] = rgb;\n      const accentBorder = `rgba(${r},${g},${b},0.30)`;\n      const accentColor = `rgba(${r},${g},${b},0.70)`;\n      for (const btn of [startBtn, pauseBtn, stopBtn, settingsBtn]) {\n        btn.style.borderColor = accentBorder;\n        btn.style.color = accentColor;\n      }\n      drawer.style.setProperty('--accent', `rgb(${r},${g},${b})`);\n      const titles = drawer.querySelectorAll<HTMLElement>('.gt-section-title');\n      for (const t of titles) t.style.color = `rgba(${r},${g},${b},0.35)`;\n    },\n    setBpm(bpm: number) {\n      currentBpm = bpm;\n      bpmSlider.value = String(bpm);\n      bpmDisplay.value = String(bpm);\n    },\n    setBars(bars: number) {\n      currentBars = bars;\n      barsSlider.value = String(Math.min(128, bars));\n      barsDisplay.value = String(bars);\n    },\n    setConfigEnabled(enabled: boolean) {\n      bpmSlider.disabled = !enabled;\n      bpmDisplay.disabled = !enabled;\n      bpmMinusBtn.disabled = !enabled;\n      bpmPlusBtn.disabled = !enabled;\n      for (const btn of bpmPresetBtns) btn.disabled = !enabled;\n      bpmHint.style.display = enabled ? 'none' : '';\n      barsSlider.disabled = !enabled;\n      barsDisplay.disabled = !enabled;\n      barsMinusBtn.disabled = !enabled;\n      barsPlusBtn.disabled = !enabled;\n      for (const btn of barsPresetBtns) btn.disabled = !enabled;\n      barsHint.style.display = enabled ? 'none' : '';\n    },\n    closeDrawer,\n  };\n\n  startBtn.style.display = 'none';\n  return ctrl;\n}\n\nexport function applyPreset(modeName: string): void {\n  const key = Object.keys(PRESETS).find(k => k.toLowerCase() === modeName.toLowerCase());\n  if (!key) return;\n  const preset = PRESETS[key];\n  for (const k of Object.keys(preset) as (keyof PhysicsParams)[]) {\n    (PHYSICS as any)[k] = preset[k];\n  }\n}\n", "/**\n * GALTON-TEMPO \u2014 main entry point.\n * \"Rhythm from Chaos, Groove from Gravity.\"\n *\n * A physics-based metronome and rhythm machine.\n * Grains are emitted on BPM beats, collide with pegs producing sounds,\n * and settle into bins creating visual rhythm patterns.\n *\n * Time authority: The Web Worker timer is the SOLE source of truth for elapsed time.\n */\n\nimport { readParams, writeParams } from './utils/url-params';\nimport { createPRNG } from './utils/seed';\nimport { Simulation } from './engine/simulation';\nimport { Renderer, getThemeByName } from './engine/renderer';\nimport { TimerBridge } from './engine/timer-bridge';\nimport { AudioEngine } from './engine/audio';\nimport { createConsole, applyPreset } from './components/console';\nimport type { SoundType } from './engine/audio';\n\n// \u2500\u2500 Bootstrap \u2500\u2500\n\nconst params = readParams();\nwriteParams(params);\n\nconst BEATS_PER_BAR = 4;\n\nlet rng = createPRNG(params.s);\n\nfunction totalBeats(): number {\n  return params.bars * BEATS_PER_BAR;\n}\n\nlet sim = new Simulation({\n  numRows: params.rows,\n  totalBeats: totalBeats(),\n  bpm: params.bpm,\n  rng,\n});\n\n// \u2500\u2500 DOM \u2500\u2500\n\nconst container = document.getElementById('app')!;\nconst renderer = new Renderer(container, params.rows, totalBeats());\n\n// \u2500\u2500 Audio \u2500\u2500\n\nconst audio = new AudioEngine();\naudio.soundType = params.sound as SoundType;\n\n// \u2500\u2500 Apply initial theme \u2500\u2500\n\nrenderer.setThemeByName(params.theme);\n\n// \u2500\u2500 Apply initial physics preset \u2500\u2500\n\napplyPreset(params.mode);\n\n// \u2500\u2500 Web Worker Timer \u2500\u2500\n\nconst timerBridge = new TimerBridge();\nlet lastBeatIndex = -1;\n\ntimerBridge.onTick = (_remainingMs, elapsedMs) => {\n  sim.setElapsedMs(elapsedMs);\n\n  // Beat detection: fire audio on each new beat\n  const currentBeat = sim.getCurrentBeat();\n  if (currentBeat > lastBeatIndex) {\n    const beatInBar = currentBeat % BEATS_PER_BAR;\n    const accent = beatInBar === 0;\n    audio.playBeat(accent);\n    lastBeatIndex = currentBeat;\n  }\n};\n\ntimerBridge.onDone = () => {\n  // All beats emitted and timer done \u2014 let particles settle\n  sim.allEmitted = true;\n};\n\n// \u2500\u2500 Console \u2500\u2500\n\nconst consoleCtrl = createConsole(\n  params.bpm,\n  params.bars,\n  params.theme,\n  params.sound as SoundType,\n  params.mode,\n);\n\n// Set initial accent color\nconsoleCtrl.setAccentColor(getThemeByName(params.theme).segmentRGB);\n\n// Auto-hide console (5 seconds)\nlet hideTimeout: ReturnType<typeof setTimeout> | null = null;\n\nfunction showConsole(): void {\n  consoleCtrl.show();\n  if (hideTimeout !== null) clearTimeout(hideTimeout);\n  hideTimeout = setTimeout(() => consoleCtrl.hide(), 5000);\n}\n\ndocument.addEventListener('mousemove', showConsole);\ndocument.addEventListener('touchstart', showConsole);\nshowConsole();\n\n// \u2500\u2500 Console callbacks \u2500\u2500\n\nconsoleCtrl.onBpmChange = (bpm: number) => {\n  params.bpm = bpm;\n  writeParams(params);\n  if (appState === 'idle') {\n    rebuildSim();\n    drawIdleFrame();\n  }\n};\n\nconsoleCtrl.onBarsChange = (bars: number) => {\n  params.bars = bars;\n  writeParams(params);\n  if (appState === 'idle') {\n    rebuildSim();\n    drawIdleFrame();\n  }\n};\n\nconsoleCtrl.onSoundChange = (sound: SoundType) => {\n  audio.soundType = sound;\n  params.sound = sound;\n  writeParams(params);\n};\n\nconsoleCtrl.onModeChange = (modeName: string) => {\n  applyPreset(modeName);\n  params.mode = modeName;\n  writeParams(params);\n};\n\nconsoleCtrl.onThemeChange = (themeName: string) => {\n  renderer.setThemeByName(themeName);\n  consoleCtrl.setThemeName(themeName);\n  consoleCtrl.setAccentColor(getThemeByName(themeName).segmentRGB);\n  params.theme = themeName.toLowerCase();\n  writeParams(params);\n  if (appState === 'idle') {\n    drawIdleFrame();\n  } else if (paused) {\n    drawPausedFrame();\n  }\n};\n\nconsoleCtrl.onShareURL = () => {\n  writeParams(params);\n  navigator.clipboard.writeText(window.location.href).catch(() => {});\n};\n\nconsoleCtrl.onResetDefaults = () => {\n  window.location.search = '';\n};\n\nconsoleCtrl.onStart = () => {\n  if (paused) {\n    togglePause();\n  } else if (appState === 'idle' || sim.allSettled) {\n    startFresh();\n  }\n};\n\nconsoleCtrl.onPause = () => togglePause();\nconsoleCtrl.onStop = () => stopToIdle();\n\n// \u2500\u2500 State \u2500\u2500\n\ntype AppState = 'running' | 'paused' | 'stopping' | 'idle';\nlet appState: AppState = 'idle';\nlet lastTime: number | null = null;\nlet paused = false;\nlet rafId = 0;\nlet hopperFadeAlpha = 1;\n\n// Snapshot of hopper state for stopping fade\nlet stoppingEmitted = 0;\nlet stoppingTotal = 0;\n\n// \u2500\u2500 Helpers \u2500\u2500\n\nfunction rebuildSim(): void {\n  rng = createPRNG(params.s);\n  sim = new Simulation({\n    numRows: params.rows,\n    totalBeats: totalBeats(),\n    bpm: params.bpm,\n    rng,\n  });\n  renderer.clearStatic();\n  renderer.resize(params.rows, totalBeats());\n}\n\nfunction drawIdleFrame(): void {\n  const tb = totalBeats();\n  renderer.drawFrame([], params.bpm, tb, 0, 0, params.bars, 0);\n}\n\nfunction drawPausedFrame(): void {\n  const currentBeat = sim.getCurrentBeat();\n  const currentBar = Math.floor(currentBeat / BEATS_PER_BAR);\n  const beatInBar = currentBeat % BEATS_PER_BAR;\n  renderer.drawFrame(\n    sim.activeParticles,\n    params.bpm,\n    sim.totalParticles,\n    sim.emittedCount,\n    currentBar,\n    params.bars,\n    beatInBar,\n  );\n}\n\nfunction togglePause(): void {\n  if (appState === 'stopping') return;\n  if (appState === 'idle') return;\n  if (sim.allSettled) return;\n\n  paused = !paused;\n  consoleCtrl.setPaused(paused);\n\n  if (paused) {\n    appState = 'paused';\n    timerBridge.pause();\n    cancelAnimationFrame(rafId);\n    drawPausedFrame();\n  } else {\n    appState = 'running';\n    timerBridge.resume();\n    lastTime = null;\n    rafId = requestAnimationFrame(frame);\n  }\n}\n\nasync function startFresh(): Promise<void> {\n  // Ensure audio context is initialized (requires user gesture)\n  await audio.ensureContext();\n\n  rebuildSim();\n  lastBeatIndex = -1;\n\n  const totalMs = totalBeats() * (60000 / params.bpm);\n\n  paused = false;\n  appState = 'running';\n  consoleCtrl.setPaused(false);\n  consoleCtrl.setConfigEnabled(false);\n\n  // Wire peg collision sounds\n  sim.onPegHit = (row, col, numRows) => {\n    audio.playPegHit(row, col, numRows);\n  };\n\n  timerBridge.start(totalMs);\n  lastTime = null;\n  rafId = requestAnimationFrame(frame);\n}\n\nfunction stopToIdle(): void {\n  if (appState === 'idle' || appState === 'stopping') return;\n  cancelAnimationFrame(rafId);\n  timerBridge.reset();\n  paused = false;\n  consoleCtrl.setPaused(true);\n\n  // Snapshot for hopper fade\n  stoppingEmitted = sim.emittedCount;\n  stoppingTotal = sim.totalParticles;\n\n  // Fill stacks with binomial distribution\n  renderer.fillStacks(params.rows, totalBeats());\n\n  // Begin hopper fade-out\n  renderer.beginHopperFade();\n  hopperFadeAlpha = 1;\n  appState = 'stopping';\n  consoleCtrl.setConfigEnabled(true);\n  lastTime = null;\n  rafId = requestAnimationFrame(frame);\n}\n\n// \u2500\u2500 Resize \u2500\u2500\n\nwindow.addEventListener('resize', () => {\n  renderer.resize(params.rows, totalBeats());\n  if (appState === 'idle') {\n    drawIdleFrame();\n  } else if (paused || sim.allSettled) {\n    drawPausedFrame();\n  }\n});\n\n// \u2500\u2500 Keyboard \u2500\u2500\n\ndocument.addEventListener('keydown', (e) => {\n  if (e.code === 'Space') {\n    e.preventDefault();\n    if (appState === 'idle') {\n      startFresh();\n    } else {\n      togglePause();\n    }\n  }\n});\n\n// \u2500\u2500 Visibility API \u2500\u2500\n\ndocument.addEventListener('visibilitychange', () => {\n  if (document.hidden) {\n    cancelAnimationFrame(rafId);\n  } else {\n    if (appState === 'running') {\n      // Snap particles that should have settled while hidden\n      const geom = renderer.getGeom();\n      const forcedSettled = sim.forceSettleActive();\n      for (const p of forcedSettled) renderer.bakeParticle(p);\n      const snapped = sim.instantSnap(geom);\n      for (const p of snapped) renderer.bakeParticle(p);\n\n      lastTime = null;\n      rafId = requestAnimationFrame(frame);\n    } else if (appState === 'stopping') {\n      lastTime = null;\n      rafId = requestAnimationFrame(frame);\n    }\n  }\n});\n\n// \u2500\u2500 Main Loop \u2500\u2500\n\nfunction frame(now: number): void {\n  if (appState === 'paused' || appState === 'idle') return;\n\n  if (lastTime === null) lastTime = now;\n  const dtMs = Math.min(now - lastTime, 100);\n  const dtSec = dtMs / 1000;\n  lastTime = now;\n\n  // \u2500\u2500 Stopping state (hopper fade-out) \u2500\u2500\n  if (appState === 'stopping') {\n    hopperFadeAlpha -= dtSec / 0.5;\n    renderer.setHopperFadeAlpha(Math.max(0, hopperFadeAlpha));\n    renderer.drawFrame([], params.bpm, stoppingTotal, stoppingEmitted, 0, params.bars, 0);\n    if (hopperFadeAlpha <= 0) {\n      appState = 'idle';\n      renderer.resetHopperFade();\n      drawIdleFrame();\n      return;\n    }\n    rafId = requestAnimationFrame(frame);\n    return;\n  }\n\n  // \u2500\u2500 Running state \u2500\u2500\n  const geom = renderer.getGeom();\n  const settled = sim.update(dtMs, geom, (x) => renderer.getGroundY(x));\n\n  for (const p of settled) {\n    renderer.bakeParticle(p);\n  }\n\n  const currentBeat = sim.getCurrentBeat();\n  const currentBar = Math.floor(currentBeat / BEATS_PER_BAR);\n  const beatInBar = currentBeat % BEATS_PER_BAR;\n\n  renderer.drawFrame(\n    sim.activeParticles,\n    params.bpm,\n    sim.totalParticles,\n    sim.emittedCount,\n    currentBar,\n    params.bars,\n    beatInBar,\n  );\n\n  if (!sim.allSettled) {\n    rafId = requestAnimationFrame(frame);\n  } else {\n    // Done \u2014 all particles have settled\n    appState = 'idle';\n    consoleCtrl.setPaused(true);\n    consoleCtrl.setConfigEnabled(true);\n  }\n}\n\n// \u2500\u2500 Initial state: idle \u2500\u2500\n\nappState = 'idle';\nconsoleCtrl.setPaused(true);\nconsoleCtrl.setConfigEnabled(true);\ndrawIdleFrame();\n"],
  "mappings": "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",
  "names": ["container", "container"]
}
